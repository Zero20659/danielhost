!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).whale=e()}(this,(function(){"use strict";function t(t,e,n){return t.addEventListener(e,n),function(){t.removeEventListener(e,n)}}function e(t){var e=t.dataset,n={};return Object.keys(e).forEach((function(t){var i;n[t]="true"===(i=e[t])||"false"!==i&&(+i+""===i?+i:"null"===i||""===i?null:i)})),n}function n(t,e){var n,i=0;if("object"==typeof(n=t)&&"number"==typeof n.length)for(var r=t.length;i<r&&!1!==e.call(t[i],t[i],i);i++);else for(i in t)if(!1===e.call(t[i],t[i],i))break;return t}function i(t){return function(e,i){e.length||(e=[e]),n(e,(function(e){e.classList[t](i)}))}}function r(t,e){return t.classList.contains(e)}var o=i("add"),s=i("remove"),c=i("toggle");function a(){return a=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},a.apply(this,arguments)}var l={start:1,time:10},u="is-active";var f={class:"is-active"};var d="is-active";var h={Tab:function(e){var i;n(e.querySelectorAll("[data-target]"),(function(e){var n=document.getElementById(e.dataset.target);r(e,u)&&(i=[e,n],o(n,u)),t(e,"click",(function(){var t=[e,n];i&&s(i,u),o(i=t,u)}))}))},Counter:function(){function n(n){this.config=a({},l,e(n)),this.element=n,this.count=this.config.start,this.active=!1,this.setContent(this.count++),this.unsubscribe=t(window,"scroll",this.handleScroll.bind(this)),this.handleScroll()}var i=n.prototype;return i.handleScroll=function(){var t,e,n,i,r;t=this.element,e=t.offsetTop,n=e+t.offsetHeight,i=window.pageYOffset,r=i+window.innerHeight,n>=i&&e<=r&&n<=r&&e>=i&&(this.interval=setInterval(this.showCounter.bind(this),this.config.time),this.unsubscribe())},i.setContent=function(t){this.element.textContent=t},i.showCounter=function(){this.setContent(this.count),this.count++>=this.config.end&&clearInterval(this.interval)},n}(),Outside:function(){function t(t){this.element=t;var n=e(t);this.config=a({},f,n),this.target=n.target?document.getElementById(n.target):this.element,this.init()}var n=t.prototype;return n.init=function(){this.element.addEventListener("click",this.handleClick.bind(this))},n.handleClick=function(t){var e=this.element,n=this.target,i=this.config.class;r(n,i)?s([e,n],i):(o([e,n],i),document.addEventListener("click",(function r(o){o===t||o.target===n||n.contains(o.target)||(s([e,n],i),document.removeEventListener("click",r))})))},t}(),Watch:function(t){!function(t,e){new window.IntersectionObserver((function(t){t.forEach((function(t){t.isIntersecting&&t.target.classList.add(e)}))}),{threshold:1}).observe(t)}(t,a({class:"is-visible"},e(t)).class)},Group:function(){function t(t){var e=t.getAttribute("data-target"),n=document.querySelectorAll(e);this.prev=null,n&&(this.targets=n,this.elements=t.querySelectorAll("[data-class]"),this.init())}var e=t.prototype;return e.init=function(){var t=this;n(this.elements,(function(e){var n=e.getAttribute("data-class");e.addEventListener("click",(function(e){t.handleClick(e,n)}))}))},e.handleClick=function(t,e){t.preventDefault();var n=this.targets,i=t.target,r=this.prev;r&&(s(n,r.previous),s(r.el,"is-active")),o(n,e),o(i,"is-active"),this.prev={previous:e,el:i}},t}(),Dropdown:function(t){t.addEventListener("click",(function(e){var n=t.parentNode;r(n,d)?s([t,n],d):(o([t,n],d),document.addEventListener("click",(function i(r){r===e||r.target===n||n.contains(r.target)||(s([t,n],d),document.removeEventListener("click",i))})))}))}};return n({add:o,remove:s,toggle:c},(function(t,e){h[e]=function(e){var n=e.getAttribute("data-target"),i=e.getAttribute("data-class")||"is-active",r=n?document.querySelectorAll(n):[e];r&&i&&e.addEventListener("click",(function(){t(r,i)}))}})),n(h,(function(t,e){var i=e.toLowerCase();n(document.querySelectorAll('[data-wjs="'+i+'"]'),(function(e){new t(e)}))})),h}));
  
function hasClass(e,t){return e.classList.contains(t)}function $$(e){return document.getElementById(e)}function $(e,t){return(t||document).querySelector(e)}function toSeconds(e){var t=e.split(":");return 60*+t[0]*60+60*+t[1]}function removeElement(e){return e.parentNode&&e.parentNode.removeChild(e)}function getTrackPosition(e,t){return(toSeconds(e)-toSeconds(t))/16+48}function setAccentColor(e,t){let n=new ColorThief;t.complete?e.setAttribute("style",`--accent: rgb(${n.getColor(t)})`):t.addEventListener("load",function(){e.setAttribute("style",`--accent: rgb(${n.getColor(t)})`)})}function createHistory(e,t){let n="";for(const o of e.slice(0,t))n+=`\n      <div class="history-item">\n        <img class="history-image bg-dark flex-none rounded-pill shadow-m mr-1" src="${o.song.art}" alt="${o.song.text}" width="120" height="120">\n        <div class="history-meta flex-1">\n          <h3 class="fs-6 fw-500 color-title">${o.song.text}</h3>\n          <span class="fs-7 opacity-.75">${o.song.artist}</span>\n        </div>\n      </div>\n    `;return n}function setPlayerMeta(e,t){let n=$(".song-cover",e),o=$(".song-title",e),a=$(".song-artist",e);n&&(n.src=t.art),o&&(o.innerText=t.text),a&&(a.innerText=t.artist)}const player=$(".player"),audioPlayer=$(".player-audio");if(audioPlayer&&audioPlayer.dataset.src){const e=new Audio(audioPlayer.dataset.src),t=$(".player-volume",audioPlayer);t.addEventListener("change",function(t){e.volume=t.currentTarget.value/100,localStorage.setItem("player_vol",e.volume)},!1);var getVolume=localStorage.getItem("player_vol");getVolume&&(e.volume=getVolume,t.value=100*getVolume);var playBtn=$(".player-toggle",audioPlayer),playIcon=$(".i-play",audioPlayer),pauseIcon=$(".i-pause",audioPlayer);playBtn.addEventListener("click",()=>{e.paused?(e.load(),player.classList.toggle("is-playing"),e.play(),playBtn.innerHTML='<svg class="i i-pause" viewBox="0 0 24 24"><path d="M5 4h4v16H5Zm10 0h4v16h-4Z"></path></svg>'):(player.classList.toggle("is-playing"),e.pause(),playBtn.innerHTML='<svg class="i i-play" viewBox="0 0 24 24"><path d="m7 3 14 9-14 9z"></path></svg>')},!1)}const japanisu="https://stream.radioani.me/api/nowplaying_static/japanisu.json";function playerInit(){fetch(japanisu).then(e=>e.json()).then(e=>{let t=e.song_history,n=$$("playerHistory"),o=$(".song-now",player),a=$(".song-next",player),s=e.now_playing.remaining,r=$(".player-poster");r&&r.src&&(r.crossOrigin="Anonymous",r.src="https://images.weserv.nl/?url="+encodeURIComponent(e.now_playing.song.art),setAccentColor(document.body,r)),o&&setPlayerMeta(o,e.now_playing.song),a&&setPlayerMeta(a,e.playing_next.song),n&&(n.innerHTML=createHistory(t,n.dataset.results||5)),setTimeout(playerInit,1e3*s)}).catch(e=>console.log(e))}playerInit();const listeners=$$("listeners");function getListeners(){fetch(japanisu).then(e=>e.json()).then(e=>{let t=e.listeners.current;listeners.innerText=t,setTimeout(getListeners,1e3*(listeners.dataset.update||5))}).catch(e=>console.log(e))}listeners&&getListeners();const program=$$("program");function setProgramStatus(){let e=new Date,t=e.toLocaleTimeString([],{timeStyle:"short"}),n=e.toLocaleString("es",{weekday:"long"}),o=program.querySelectorAll(".program-item"),a=toSeconds(t);o.forEach(e=>{if(e.dataset.week==n){e.querySelectorAll(".upcoming").forEach(e=>{let t=toSeconds(e.dataset.start),n=toSeconds(e.dataset.end);t<a&&n>a&&e.classList.add("is-online")})}})}program&&(setProgramStatus(),setInterval(setProgramStatus,6e4));const programming=$$("programming");function setTimePosition(){let e=(new Date).toLocaleTimeString([],{timeStyle:"short"});programming.querySelectorAll(".upcoming").forEach(t=>{let n=getTrackPosition(t.dataset.start,e);t.setAttribute("style",`transform: translateX(${n}px)`),t.classList.add("is-loaded")}),console.log(e)}programming&&(setTimePosition(),setInterval(setTimePosition,6e4));